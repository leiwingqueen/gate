package com.elend.gate.channel.facade;

import java.math.BigDecimal;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import com.elend.gate.channel.PartnerResult;
import com.elend.gate.channel.constant.BankIdConstant;
import com.elend.gate.channel.constant.WithdrawChannel;
import com.elend.gate.channel.facade.vo.PartnerWithdrawData;
import com.elend.gate.channel.facade.vo.WithdrawCallbackData;
import com.elend.gate.channel.facade.vo.WithdrawSingleQueryData;
import com.elend.gate.conf.constant.PartnerConstant;
import com.elend.p2p.util.HttpUtils;
import com.elend.p2p.util.OrderIdHelper;

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath*:config/spring/*.xml" })
public class WithdrawChannelFacadeTest {
    
    @Autowired
    private WithdrawChannelFacade withdrawChannelFacade;

    @Test
    public void testWithdrawSingle() {
        String orderId = OrderIdHelper._newOrderId("bf_");
        PartnerWithdrawData data = new PartnerWithdrawData();
        
        data.setAccountType("2");
        data.setAmount(BigDecimal.ONE);
        data.setBankAccount("6222023602037792464");
        data.setBankBranchName("天河支行");
        data.setBankCityId("4402");
        data.setBankId(BankIdConstant.ICBC);
        data.setBankProvinceId("4401");
        data.setChannel(WithdrawChannel.BAOFOO_WITHDRAW);
        data.setIp("127.0.0.1");
        data.setNotifyUrl("12345678");
        data.setPartnerId(PartnerConstant.P2P);
        data.setPartnerOrderId("1245787874");
        data.setUserName("刘新区");
        
        PartnerResult<WithdrawCallbackData> withdrawSingle = withdrawChannelFacade.withdrawSingle(WithdrawChannel.BAOFOO_WITHDRAW, orderId, data);
        System.out.println(withdrawSingle);
    }

    @Test
    public void testWithdrawCallback() {
        
        //PartnerResult<WithdrawCallbackData> result = withdrawChannelFacade.withdrawCallback(WithdrawChannel.BAOFOO_WITHDRAW, "member_id=100000178&terminal_id=100000859&data_type=XML&data_content=77f530811dd320e5a63118d92f44ec2f8a21574c8bf4a9b565ef24558fa0299d75f49bb7eb4e5ffeeae429cdac8a81aeb786447445f1163445a7fdd9ef9b3dbec373c386fa74e79f01aed5b5c3e31c9059ed24fbeb0ce364bef446246542e5bd88ac49c11eff88284bf10bd41736e5f10843954cd922ea11f9f40d965a7fa11057ed6b1b95b568aa3e7ffb0de6acc85394b72604ffde43cceacf8275f408e4d33e4454a0a78592f0c28af627a483b1745d6c9c8be6e9cbb2914f66e0afb35f447118cb8d22ec3f1c4f50c660e87e9eb099049e7233f8f4f797a8284db7fa71396807b99ad0c654924efdb1d1a6d067acbc3bfcfff36d0382eac302e3e8c63ced996585823363ccd616b737b9b19c4dcbbda49c5bddf27781ce307ac891cd6dc224d5b78aa518cc76a48af7435c93f9b680ed54fb4e492612a6b898d2a5370da5047c82ae8886ed89bb3cdd0d70227b3e3d9eb6fab3615a9862ddbc07e65607e9ab95150441dfd406abb70c5be414290b1e6b2f8d09fc4ff8477b477e181885b95e7bbc676e8f602b6138fa615864039c7cf89c309e0d7cc263d29bcb77f2ca6938dd85d5a0ab9f2a6d2ca9b495add30937800eadde526017675375d398ddb8d5e6164974acdaa9c951c40afbf9b1fbb02b60438d42cb51c87eb74535922b15b2ab05e0b823d8156d431d83d50f6733f34f32914bbd5eb2d9b2219e714e8cae030e8f2970bdfd79aab47c697b235b26991f048f249a0e999f254a5da4a981222745db8a98be3fcf06e950c31f83252d23b93aa3b96c19a317d068a03d8ecf49273b25f7ca7c8e9eaaaac2adaab8e38f6de9c3b8322370a123ebf93a49bb527efd445f7deca3f92542e8966a426edc43d6f8101dc281a8d14a64ed79521c8c1cb48b2ae08cd03fa14c8a7158823e594d31d6504fa91cf4381f77b1cd57d9b2522d7fdbf96a936b373aa5472cd23da1334ad432f5155d4f9bf22440db92689345f4211523a5a01c249fd9155b138a1a0037f85fc1914ead59fa70a7f7c62ac60326b9035b5abcc9db1f721c6df7579f076d6270fa6bda62f7b007fd0eccd661eaf070722abfc9f2fe0cbcd6d23ff14f399fc000692ad818a095b8972b69341e1fc50d49076e33819f52a03d7ef25d95d6562781024d9bc48f10153c9e56f9a6a140a9fc6191497a01b47b0c3c4fd46872821e30636625875aedc13d309356db9f98ab7fcb315eaaf8142c5990bb8ed3f39c2e10162cc0cfff40dd673a2ee365eada2d9131c87343bcb1106b8c8a2f7d9ed4b1948fa5c0b116ae9e90894834cf7c81cd21dbeec093edd26feca33c163719b22a1063e24f3f23723e2b92df443d20ba9a040d8535fa80671807e67cc1e9443e8410c7f69bf5f783337be9abf9a869876777293f84f5a7d7a79c0a85a22734d9e395a68bcb9c46adaa874d13fca92790");
        PartnerResult<WithdrawCallbackData> result = withdrawChannelFacade.withdrawCallback(WithdrawChannel.BAOFOO_WITHDRAW, "member_id=100000178&terminal_id=100000859&data_type=XML&data_content=77f530811dd320e5a63118d92f44ec2f8a21574c8bf4a9b565ef24558fa0299d75f49bb7eb4e5ffeeae429cdac8a81aeb786447445f1163445a7fdd9ef9b3dbec373c386fa74e79f01aed5b5c3e31c9059ed24fbeb0ce364bef446246542e5bd88ac49c11eff88284bf10bd41736e5f10843954cd922ea11f9f40d965a7fa11057ed6b1b95b568aa3e7ffb0de6acc85394b72604ffde43cceacf8275f408e4d33e4454a0a78592f0c28af627a483b1745d6c9c8be6e9cbb2914f66e0afb35f447118cb8d22ec3f1c4f50c660e87e9eb099049e7233f8f4f797a8284db7fa71396807b99ad0c654924efdb1d1a6d067acbc3bfcfff36d0382eac302e3e8c63ced996585823363ccd616b737b9b19c4dcbbda49c5bddf27781ce307ac891cd6dc224d5b78aa518cc76a48af7435c93f9b680ed54fb4e492612a6b898d2a5370da5047c82ae8886ed89bb3cdd0d70227b3e3d9eb6fab3615a9862ddbc07e65607e9ab95150441dfd406abb70c5be414290b1e6b2f8d09fc4ff8477b477e181885b95e7bbc676e8f602b6138fa615864039c7cf89c309e0d7cc263d29bcb77f2ca6938dd85d5a0ab9f2a6d2ca9b495add30937800eadde526017675375d398ddb8d5e6164974acdaa9c951c40afbf9b1fbb02b60438d42cb51c87eb74535922b15b2ab05e0b823d8156d431d83d50f6733f34f32914bbd5eb2d9b2219e714e8cae030e8f2970bdfd79aab47c697b235b26991f048f249a0e999f254a5da4a981222745db8a98be3fcf06e950c31f83252d23b93aa3b96c19a317d068a03d8ecf49273b25f7ca7c8e9eaaaac2adaab8e38f6de9c3b8322370a123ebf93a49bb527efd445f7deca3f92542e8966a426edc43d6f8101dc281a8d14a64ed79521c8c1cb48b2ae08cd03fa14c8a7158823e594d31d6504fa91cf4381f77b1cd57d9b2522d7fdbf96a936b373aa5472cd23da1334ad432f5155d4f9bf22440db92689345f4211523a5a01c249fd9155b138a1a0037f85fc1914ead59fa70a7f7c62ac60326b9035b5abcc9db1f721c6df7579f076d6270fa6bda62f7b007fd0eccd661eaf070722abfc9f2fe0cbcd6d23ff14f399fc000692ad818a095b8972b69341e1fc50d49076e33819f52a03d7ef25d95d6562781024d9bc48f10153c9e56f9a6a140a9fc6191497a01b47b0c3c4fd46872821e30636625875aedc13d309356db9f98ab7fcb315eaaf8142c5990bb8ed3f39c2e10162cc0cfff40dd673a2ee365eada2d9131c87343bcb1106b8c8a2f7d9ed4b1948fa5c0b116ae9e90894834cf7c81cd21dbeec093edd26feca33c163719b22a1063e24f3f23723e2b92df443d20ba9a040d8535fa80671807e67cc1e9443e8410c7f69bf5f783337be9abf9a869876777293f84f5a7d7a79c0a85a22734d9e395a68bcb9c46adaa874d13fca92790");
        System.out.println(result);
    }

    @Test
    public void testWithdrawSingleQuery() {
        PartnerResult<WithdrawCallbackData> withdrawSingleQuery = withdrawChannelFacade.withdrawSingleQuery(WithdrawChannel.BAOFOO_WITHDRAW, "bf_160901160839044089960001");
        System.out.println(withdrawSingleQuery);
    }
    
    
    @Test
    public void testWithdrawCallback2() {
        
        String doPost = HttpUtils.doPost("http://test.gate.gzdai.com/baofoo/withdrawNotify.do", "member_id=100000178&terminal_id=100000859&data_type=XML&data_content=77f530811dd320e5a63118d92f44ec2f8a21574c8bf4a9b565ef24558fa0299d75f49bb7eb4e5ffeeae429cdac8a81aeb786447445f1163445a7fdd9ef9b3dbec373c386fa74e79f01aed5b5c3e31c9059ed24fbeb0ce364bef446246542e5bd88ac49c11eff88284bf10bd41736e5f10843954cd922ea11f9f40d965a7fa11057ed6b1b95b568aa3e7ffb0de6acc85394b72604ffde43cceacf8275f408e4d33e4454a0a78592f0c28af627a483b1745d6c9c8be6e9cbb2914f66e0afb35f447118cb8d22ec3f1c4f50c660e87e9eb099049e7233f8f4f797a8284db7fa71396807b99ad0c654924efdb1d1a6d067acbc3bfcfff36d0382eac302e3e8c63ced996585823363ccd616b737b9b19c4dcbbda49c5bddf27781ce307ac891cd6dc224d5b78aa518cc76a48af7435c93f9b680ed54fb4e492612a6b898d2a5370da5047c82ae8886ed89bb3cdd0d70227b3e3d9eb6fab3615a9862ddbc07e65607e9ab95150441dfd406abb70c5be414290b1e6b2f8d09fc4ff8477b477e181885b95e7bbc676e8f602b6138fa615864039c7cf89c309e0d7cc263d29bcb77f2ca6938dd85d5a0ab9f2a6d2ca9b495add30937800eadde526017675375d398ddb8d5e6164974acdaa9c951c40afbf9b1fbb02b60438d42cb51c87eb74535922b15b2ab05e0b823d8156d431d83d50f6733f34f32914bbd5eb2d9b2219e714e8cae030e8f2970bdfd79aab47c697b235b26991f048f249a0e999f254a5da4a981222745db8a98be3fcf06e950c31f83252d23b93aa3b96c19a317d068a03d8ecf49273b25f7ca7c8e9eaaaac2adaab8e38f6de9c3b8322370a123ebf93a49bb527efd445f7deca3f92542e8966a426edc43d6f8101dc281a8d14a64ed79521c8c1cb48b2ae08cd03fa14c8a7158823e594d31d6504fa91cf4381f77b1cd57d9b2522d7fdbf96a936b373aa5472cd23da1334ad432f5155d4f9bf22440db92689345f4211523a5a01c249fd9155b138a1a0037f85fc1914ead59fa70a7f7c62ac60326b9035b5abcc9db1f721c6df7579f076d6270fa6bda62f7b007fd0eccd661eaf070722abfc9f2fe0cbcd6d23ff14f399fc000692ad818a095b8972b69341e1fc50d49076e33819f52a03d7ef25d95d6562781024d9bc48f10153c9e56f9a6a140a9fc6191497a01b47b0c3c4fd46872821e30636625875aedc13d309356db9f98ab7fcb315eaaf8142c5990bb8ed3f39c2e10162cc0cfff40dd673a2ee365eada2d9131c87343bcb1106b8c8a2f7d9ed4b1948fa5c0b116ae9e90894834cf7c81cd21dbeec093edd26feca33c163719b22a1063e24f3f23723e2b92df443d20ba9a040d8535fa80671807e67cc1e9443e8410c7f69bf5f783337be9abf9a869876777293f84f5a7d7a79c0a85a22734d9e395a68bcb9c46adaa874d13fca92790");
        
        System.out.println(doPost);
    }

}
